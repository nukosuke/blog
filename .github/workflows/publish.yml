name: Publish

on:
  # Triggers the workflow on push or pull request events but only for the main branch
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: purcell/setup-emacs@master
        with:
          version: 27.1
      - name: Retrieve org-static-blog.el
        run: curl -O https://raw.githubusercontent.com/bastibe/org-static-blog/1.5.0/org-static-blog.el
      - uses: actions/checkout@v2
      - name: Build
        run: emacs -Q --batch -l org-static-blog.el -l config.el -f org-static-blog-publish
